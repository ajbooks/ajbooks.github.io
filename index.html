<!DOCTYPE html>
<html>
  <head>
    <title>Mi página web</title>
  </head>
  <body>
    <h1>Bienvenido a mi página web</h1>
    <p>Parámetro pzid: <span id="pzid-value"></span></p>

    <script>
      function getParameterByName(name) {
        var url = window.location.href;
        name = name.replace(/[\[\]]/g, '\\$&');
        var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)');
        var results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, ' '));
      }

      var pzid = getParameterByName('pzid');
      document.getElementById('pzid-value').textContent = pzid;

      // Llamada a la Apps Script de Google
      var scriptUrl = 'https://script.google.com/macros/s/AKfycbw6HN7DbIH47lwtMRDJ7nKe-3RA81El92ziuqXKK6kF3dDuEc8ptFfxrhKq4vENRLB2bA/exec';
      var payload = {
        'pzid': pzid
      };

      fetch(scriptUrl, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(payload)
      })
      .then(response => response.text())
      .then(data => console.log(data))
      .catch(error => console.error(error));
    </script>
  </body>
</html>
